!function(e){e(function(){e("body").wc_bis_form(),e("body").wc_bis_loop_signup_prompt()});function i(){this.$body=e("body"),this.$variations_form=this.$body.find("form.variations_form"),this.has_errors=!1,this.handle_form=this.handle_form.bind(this),this.$body.on("click","#wc_bis_send_form",this.handle_form)}function r(){this.$body=e("body"),this.handle_redirect=this.handle_redirect.bind(this),this.$body.on("click",".js_wc_bis_loop_signup_prompt_trigger_redirect",this.handle_redirect)}i.prototype.parse_product_id=function(i){var r=!1;return(r=i.length?parseInt(i.data("bis-product-id"),10):r)&&0!==r||(window.console.error("BIS Error: Could not parse product id."),this.has_errors=!0),r},i.prototype.parse_variation_id=function(){var i,r=!1;return this.$variations_form.length&&(i=this.$variations_form.find(".woocommerce-variation-add-to-cart").first(),0===(r=parseInt(i.find('input[name="variation_id"]').val(),10))&&(window.console.error("BIS Error: Could not parse variation id."),this.has_errors=!0)),r},i.prototype.parse_variation_attributes=function(){var o=[];return this.$variations_form.length&&this.$variations_form.find(".variations select").each(function(i,r){var t=e(this);o.push(t)}),o},i.prototype.add_hidden_input=function(i,r,t){var o=e("<input/>");o.val(r),o.prop("name",i),t.append(o)},i.prototype.handle_form=function(i){i.preventDefault(),this.has_errors=!1;var r=this.$body.find("> #wc_bis_product_live_form");r.length&&r.remove();var r=e(i.target).closest("#wc_bis_product_form"),i=r.find("#wc_bis_email"),t=(i.length&&""===i.val()&&(this.has_errors=!0),e("<form/>")),i=r.find(":input"),i=(t.prop("method","post"),t.prop("id","wc_bis_product_live_form"),t.append(i.clone()),this.add_hidden_input("wc_bis_product_live_form",!0,t),this.add_hidden_input("security",wc_bis_params.registration_form_nonce,t),this.parse_product_id(r)),r=(this.add_hidden_input("wc_bis_product_id",i,t),this.parse_variation_id());if(r){this.add_hidden_input("wc_bis_variation_id",r,t);for(var o=this.parse_variation_attributes(),n=o.length-1;0<=n;n--)this.add_hidden_input(o[n].prop("name"),o[n].val(),t)}this.has_errors||(t.hide(),this.$body.append(t),t.submit())},e.fn.wc_bis_form=function(){return new i,this};r.prototype.handle_redirect=function(i){i.preventDefault(),this.has_errors=!1;var r=this.$body.find("> #wc_bis_loop_signup_live_form"),i=(r.length&&r.remove(),e(i.target)),t=e("<form/>"),o=(t.prop("method","post"),t.prop("id","wc_bis_loop_signup_live_form"),t.prop("action",""),this.add_hidden_input("wc_bis_loop_signup_form",!0,t),this.parse_product_id(i)),i=this.parse_redirect_url(i);o?((r=this.$body.find("> #wc_bis_product_live_form")).length&&r.remove(),this.add_hidden_input("wc_bis_product_id",o,t),this.add_hidden_input("wc_bis_product_live_form",!0,t),this.add_hidden_input("security",wc_bis_params.registration_form_nonce,t)):i.length&&(t.prop("action",i),this.add_hidden_input("wc_bis_loop_signup_prompt_posted",!0,t)),this.has_errors||(t.hide(),this.$body.append(t),t.submit())},r.prototype.parse_product_id=function(i){var r=!1;return void 0!==i.data("bis-loop-product-id")&&((r=i.length?parseInt(i.data("bis-loop-product-id"),10):r)&&0!==r||(window.console.error("BIS Error: Could not parse product id."),this.has_errors=!0),r)},r.prototype.parse_redirect_url=function(i){var r=!1;return void 0!==i.data("bis-loop-redirect-to")&&((r=i.length?i.data("bis-loop-redirect-to"):r)&&r.length||(window.console.error("BIS Error: Could not parse redirect url."),this.has_errors=!0),r)},r.prototype.add_hidden_input=function(i,r,t){var o=e("<input/>");o.val(r),o.prop("name",i),t.append(o)},e.fn.wc_bis_loop_signup_prompt=function(){return new r,this}}(jQuery);